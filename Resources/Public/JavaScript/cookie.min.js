/*!
  * Cookie Consent Adapter
  * Copyright 2018 Dirk Persky (https://github.com/DirkPersky/typo3-dp_cookieconsent)
  * Licensed under GPL v3+ (https://github.com/DirkPersky/typo3-dp_cookieconsent/blob/master/LICENSE)
  */
window.addEventListener("load",function(){function o(){this.cookie_name="dp_cookieconsent_status",this.cookie={path:"/",domain:"",expiryDays:365,secure:!1}}o.prototype.asyncLoad=function(o,e,t){var i=document,s=i.createElement(e),n=i.getElementsByTagName(e)[0];switch(e){case"script":s.src=o,s.setAttribute("defer","");break;case"link":s.rel="stylesheet",s.type="text/css",s.setAttribute("defer",""),s.href=o}t&&s.addEventListener("load",function(o){t(null,o)},!1),n.parentNode.insertBefore(s,n)},o.prototype.asyncJS=function(o,e){this.asyncLoad(o,"script",e)},o.prototype.asyncCSS=function(o){this.asyncLoad(o,"link")},o.prototype.loadCookies=function(){var o=[];if(void 0===document.querySelectorAll)o=document.querySelectorAll("script[data-cookieconsent]");else{var e=document.getElementsByTagName("script");for(var t in e){void 0!==(i=e[t]).getAttribute&&i.getAttribute("data-cookieconsent")&&o.push(i)}e=null}if(o.length>0)for(var t in o){var i,s=o[t].innerHTML;if(s&&s.length&&(s=s.trim()),"dpextend"===window.cookieconsent_options.layout){var n=o[t].dataset.cookieconsent;if("rquired"!=n&&(this.loadCookiesPreset(),!this.dpCookies.hasOwnProperty("dp--cookie-"+n)||!0!==this.dpCookies["dp--cookie-"+n]))continue}if(s&&s.length)eval.call(this,s);else(i=o[t]).getAttribute("data-src")?this.asyncJS(i.getAttribute("data-src")):i.src&&this.asyncJS(i.src)}},o.prototype.load=function(){this.asyncCSS(window.cookieconsent_options.css),"dpextend"==window.cookieconsent_options.layout&&this.asyncCSS(window.cookieconsent_options.dpCSS),this.asyncJS(window.cookieconsent_options.js,this.init)},o.prototype.setClass=function(o){!0===o?document.querySelector("body").classList.remove("dp--cookie-consent"):document.querySelector("body").classList.add("dp--cookie-consent")},o.prototype.setCheckboxes=function(){if("dpextend"==window.cookieconsent_options.layout){var o=this.loadCheckbox("dp--cookie-statistics"),e=this.loadCheckbox("dp--cookie-marketing");this.saveCookie([o,e])}},o.prototype.loadCheckboxes=function(){if("dpextend"==window.cookieconsent_options.layout){this.loadCookiesPreset();this.loadCheckbox("dp--cookie-statistics",!0),this.loadCheckbox("dp--cookie-marketing",!0)}},o.prototype.saveCookie=function(o){var e={};o.map(function(o){e[o.id]=o.checked}),window.cookieconsent.utils.setCookie(this.cookie_name,JSON.stringify(e),this.cookie.expiryDays,this.cookie.domain,this.cookie.path,this.cookie.secure)},o.prototype.loadCookiesPreset=function(){if(0!=this.dpCookies&&(this.dpCookies=window.cookieconsent.utils.getCookie(this.cookie_name)),void 0!==this.dpCookies)try{this.dpCookies=JSON.parse(this.dpCookies)}catch(o){this.dpCookies=!1}else this.dpCookies=!1},o.prototype.loadCheckbox=function(o,e){var t=document.getElementById(o);return!0===e&&this.dpCookies&&this.dpCookies.hasOwnProperty(o)&&(t.checked=this.dpCookies[o]),t},o.prototype.init=function(){window.cookieconsent.initialise({content:window.cookieconsent_options.content,theme:window.cookieconsent_options.theme,position:window.cookieconsent_options.position,palette:window.cookieconsent_options.palette,dismissOnScroll:window.cookieconsent_options.dismissOnScroll,type:window.cookieconsent_options.type,layout:window.cookieconsent_options.layout,revokable:window.cookieconsent_options.revokable,cookie:(new o).cookie,layouts:{dpextend:"{{dpmessagelink}}{{compliance}}"},elements:{dpmessagelink:'<span id="cookieconsent:desc" class="cc-message">{{message}} <a aria-label="learn more about cookies" role=button tabindex="0" class="cc-link" href="{{href}}" rel="noopener noreferrer nofollow" target="{{target}}">{{link}}</a><div class="dp--cookie-check"><label for="dp--cookie-require"><input type="checkbox" id="dp--cookie-require" class="dp--check-box" disabled="disabled" checked="checked"> {{dpRequire}}</label><label for="dp--cookie-statistics"><input type="checkbox" id="dp--cookie-statistics" class="dp--check-box"> {{dpStatistik}}</label><label for="dp--cookie-marketing"><input type="checkbox" id="dp--cookie-marketing" class="dp--check-box" > {{dpMarketing}}</label></div></span>'},onPopupOpen:function(){(new o).setClass(),(new o).loadCheckboxes()},onPopupClose:function(){(new o).setClass(!0)},onInitialise:function(e){!this.hasConsented()||"dismiss"!=e&&"allow"!=e||(new o).loadCookies()},onStatusChange:function(e){(new o).setCheckboxes(),!this.hasConsented()||"dismiss"!=e&&"allow"!=e||(new o).loadCookies()},onRevokeChoice:function(){}})},(new o).load()});
